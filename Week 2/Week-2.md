# Week 2 Practice

## Problem 1

Pull total number of orders that were completed on 18th March 2023

__Code:__

```sql
SELECT
  COUNT(DISTINCT order_id)
FROM
  sales
WHERE
  date = "03-18-2023"
```

## Problem 2

Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’

__Code:__

```sql
SELECT
  COUNT(DISTINCT s.order_id)
FROM
  sales as s
  LEFT JOIN customers as c on s.customer_id = c.customer_id
WHERE
  c.first_name = 'John'
  and c.last_name = 'Doe'
  and s.date = "03-18-2023"
```

## Problem 3

Pull total number of customers that purchased in January 2023 and the average amount spend per customer

__Code:__

```sql
SELECT
  COUNT(DISTINCT customer_id) as total_number_of_customers,
  SUM(revenue)/COUNT(DISTINCT customer_id) as amount_spend_per_customer
FROM
  sales 
WHERE
  CAST(date as string) like "01-%-2023"
```

## Problem 4

Pull the departments that generated less than $600 in 2022

__Code:__

```sql
SELECT
  i.department
FROM
  sales as s
  LEFT JOIN items as i on s.item_id = i.item_id
GROUP BY
  i.department
WHERE
  CAST(s.date as string) like "%-2022"
  and SUM(s.revenue) < 600
```

## Problem 5

What is the most and least revenue we have generated by an order

__Code:__

```sql
SELECT
  MAX(SUM(revenue)) as most_revenue,
  MIN(SUM(revenue)) as least_revenue
FROM
  sales
GROUP BY
  order_id

```

## Problem 6

What were the items that were purchased in our most lucrative order

__Code:__

```sql
SELECT
  i.item_name
FROM
  sales as s
  LEFT JOIN items as i on s.item_id = i.item_id
WHERE
  s.order_id = (
    SELECT
      order_id
    FROM
      sales
    GROUP BY
      order_id
    WHERE
      SUM(revenue) = MAX(SUM(revenue))
  )
```


